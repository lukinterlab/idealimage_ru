# Generated by Django 5.1 on 2025-10-15 12:43

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('Asistent', '0021_add_priority_to_knowledge'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ChatbotFAQ',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('question', models.CharField(help_text='–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞', max_length=500, verbose_name='–í–æ–ø—Ä–æ—Å')),
                ('answer', models.TextField(help_text='–ì–æ—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç —á–∞—Ç-–±–æ—Ç–∞ (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTML)', verbose_name='–û—Ç–≤–µ—Ç')),
                ('keywords', models.JSONField(default=list, help_text="–°–ø–∏—Å–æ–∫ —Å–ª–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞: ['–∞–≤—Ç–æ—Ä', '–∑–∞—è–≤–∫–∞', '—Å—Ç–∞—Ç—å—è']", verbose_name='–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞')),
                ('related_url', models.CharField(blank=True, help_text='–°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: /visitor/apply-role/)', max_length=500, verbose_name='–°—Å—ã–ª–∫–∞')),
                ('priority', models.IntegerField(default=50, help_text='–ß–µ–º –≤—ã—à–µ - —Ç–µ–º –≤–∞–∂–Ω–µ–µ (90+ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏)', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç')),
                ('is_active', models.BooleanField(default=True, help_text='–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç FAQ', verbose_name='–ê–∫—Ç–∏–≤–µ–Ω')),
                ('usage_count', models.IntegerField(default=0, help_text='–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª –ø–æ–∫–∞–∑–∞–Ω —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç', verbose_name='–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è')),
            ],
            options={
                'verbose_name': 'FAQ —á–∞—Ç-–±–æ—Ç–∞',
                'verbose_name_plural': 'FAQ —á–∞—Ç-–±–æ—Ç–∞',
                'ordering': ['-priority', '-usage_count'],
            },
        ),
        migrations.CreateModel(
            name='ChatbotSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('system_prompt', models.TextField(default='–¢—ã –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Å–∞–π—Ç–∞ IdealImage.ru - –∂–µ–Ω—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞ –æ –∫—Ä–∞—Å–æ—Ç–µ, –º–æ–¥–µ –∏ –∑–¥–æ—Ä–æ–≤—å–µ.\n        \n–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Å–∞–π—Ç–µ –≤–µ–∂–ª–∏–≤–æ –∏ –ø–æ-—Ä—É—Å—Å–∫–∏\n- –ü–æ–º–æ–≥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é\n- –û–±—ä—è—Å–Ω—è—Ç—å, –∫–∞–∫ —Å—Ç–∞—Ç—å –∞–≤—Ç–æ—Ä–æ–º\n- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–ª–µ–∑–Ω—ã–µ —Å—Ç–∞—Ç—å–∏\n- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º\n\n–°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è: –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π.\n–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫.', help_text='–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —á–∞—Ç-–±–æ—Ç–∞: –∫–∞–∫ —Å–µ–±—è –≤–µ—Å—Ç–∏, —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è', verbose_name='–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç')),
                ('welcome_message', models.TextField(default='–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üëã –Ø –ø–æ–º–æ—â–Ω–∏–∫ IdealImage.ru. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?', help_text='–ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞', verbose_name='–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ')),
                ('use_ai', models.BooleanField(default=False, help_text='‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ - —Ç–æ–ª—å–∫–æ FAQ –∏ –ø–æ–∏—Å–∫ —Å—Ç–∞—Ç–µ–π (—ç–∫–æ–Ω–æ–º–∏—è —Ç–æ–∫–µ–Ω–æ–≤)', verbose_name='–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GigaChat AI')),
                ('search_articles', models.BooleanField(default=True, help_text='–ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –±–ª–æ–≥–∞', verbose_name='–ò—Å–∫–∞—Ç—å –ø–æ —Å—Ç–∞—Ç—å—è–º')),
                ('max_search_results', models.IntegerField(default=3, help_text='–°–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–µ–π –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –æ—Ç–≤–µ—Ç–µ (1-10)', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(10)], verbose_name='–ú–∞–∫—Å. —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞')),
                ('admin_contact_enabled', models.BooleanField(default=True, help_text="–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É '–°–≤—è–∑–∞—Ç—å—Å—è —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º'", verbose_name='–†–∞–∑—Ä–µ—à–∏—Ç—å —Å–≤—è–∑—å —Å –∞–¥–º–∏–Ω–æ–º')),
                ('admin_email', models.EmailField(default='admin@idealimage.ru', help_text='–ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', max_length=254, verbose_name='Email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞')),
                ('rate_limit_messages', models.IntegerField(default=10, help_text='–î–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞ (–Ω–∞ –æ–¥–Ω—É —Å–µ—Å—Å–∏—é)', validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(100)], verbose_name='–õ–∏–º–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Å')),
                ('is_active', models.BooleanField(default=True, help_text='–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —á–∞—Ç-–±–æ—Ç–∞', verbose_name='–ß–∞—Ç-–±–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ')),
            ],
            options={
                'verbose_name': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç-–±–æ—Ç–∞',
                'verbose_name_plural': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç-–±–æ—Ç–∞',
            },
        ),
        migrations.AlterField(
            model_name='aiknowledgebase',
            name='category',
            field=models.CharField(choices=[('–ø—Ä–æ–º–ø—Ç—ã', '–ü—Ä–æ–º–ø—Ç—ã'), ('–ø—Ä–∞–≤–∏–ª–∞', '–ü—Ä–∞–≤–∏–ª–∞'), ('–ø—Ä–∏–º–µ—Ä—ã', '–ü—Ä–∏–º–µ—Ä—ã'), ('–∫–æ–º–∞–Ω–¥—ã', '–ö–æ–º–∞–Ω–¥—ã'), ('faq', '–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã'), ('–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏', '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏'), ('–∏—Å—Ç–æ—á–Ω–∏–∫–∏', '–ò—Å—Ç–æ—á–Ω–∏–∫–∏')], max_length=100, verbose_name='–ö–∞—Ç–µ–≥–æ—Ä–∏—è'),
        ),
        migrations.CreateModel(
            name='ChatMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('session_key', models.CharField(db_index=True, max_length=255, verbose_name='–ö–ª—é—á —Å–µ—Å—Å–∏–∏')),
                ('message', models.TextField(verbose_name='–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è')),
                ('response', models.TextField(verbose_name='–û—Ç–≤–µ—Ç —á–∞—Ç-–±–æ—Ç–∞')),
                ('source', models.CharField(choices=[('faq', 'FAQ'), ('article_search', '–ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—å—è–º'), ('ai', 'GigaChat AI'), ('error', '–û—à–∏–±–∫–∞')], max_length=20, verbose_name='–ò—Å—Ç–æ—á–Ω–∏–∫ –æ—Ç–≤–µ—Ç–∞')),
                ('found_articles', models.JSONField(blank=True, default=list, help_text='–°–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –æ—Ç–≤–µ—Ç–µ', verbose_name='–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç–∞—Ç—å–∏')),
                ('processing_time', models.FloatField(default=0, help_text='–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω—è–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞', verbose_name='–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—Å–µ–∫)')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP-–∞–¥—Ä–µ—Å')),
                ('user_agent', models.TextField(blank=True, verbose_name='User Agent')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True, verbose_name='–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è')),
                ('user', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='chat_messages', to=settings.AUTH_USER_MODEL, verbose_name='–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')),
            ],
            options={
                'verbose_name': '–°–æ–æ–±—â–µ–Ω–∏–µ —á–∞—Ç–∞',
                'verbose_name_plural': '–°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['session_key', '-created_at'], name='Asistent_ch_session_8ad3e1_idx'), models.Index(fields=['user', '-created_at'], name='Asistent_ch_user_id_781cbc_idx')],
            },
        ),
    ]
