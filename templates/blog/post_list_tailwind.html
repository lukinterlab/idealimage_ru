{% extends 'base_tailwind.html' %}
{% load static %}
{% load ad_tags %}
{% load video_tags %}

{% block page_header %}
<!-- Hero Section -->
<div class="gradient-primary rounded-2xl px-8 py-[0.0625rem] md:px-12 md:py-[0.09375rem] mb-0 text-white fade-in">
    <div class="max-w-4xl">
        <h1 class="text-3xl md:text-4xl font-heading font-bold mb-1">
            {% if current_category %}
                {{ current_category.title }}
            {% elif current_tag %}
                {{ current_tag.name }}
            {% elif author %}
                –°—Ç–∞—Ç—å–∏ –∞–≤—Ç–æ—Ä–∞: {{ author.username }}
            {% elif profile %}
                –°—Ç–∞—Ç—å–∏ –∞–≤—Ç–æ—Ä–∞: {{ profile.vizitor.username }}
            {% else %}
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ IdealImage.ru
            {% endif %}
        </h1>
        <p class="text-base md:text-lg opacity-90">
            {% if current_category %}
                {{ current_category.description|default:"–í—Å–µ —Å—Ç–∞—Ç—å–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"|safe }}
            {% elif current_tag %}
                –°—Ç–∞—Ç—å–∏ –ø–æ —Ç–µ–º–µ "{{ current_tag.name }}"
            {% elif author %}
                –í—Å–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∞ {{ author.get_full_name|default:author.username }}
            {% elif profile %}
                –í—Å–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∞ {{ profile.vizitor.get_full_name|default:profile.vizitor.username }}
            {% else %}
                –û—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è –º–∏—Ä –º–æ–¥—ã, –∫—Ä–∞—Å–æ—Ç—ã –∏ —Å—Ç–∏–ª—è. –í–¥–æ—Ö–Ω–æ–≤–ª—è–π—Ç–µ—Å—å –ª—É—á—à–∏–º–∏ —Ç—Ä–µ–Ω–¥–∞–º–∏ –∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑.
            {% endif %}
        </p>
    </div>
</div>

<!-- Tags Section -->
<div class="mb-0 relative -mt-2">
    <!-- Animated Background -->
    <div class="absolute inset-0 bg-gradient-to-r from-pink-100 via-purple-100 to-blue-100 rounded-3xl opacity-50 blur-xl"></div>
    
    <div class="relative bg-white/80 backdrop-blur-sm rounded-3xl px-6 py-1 shadow-xl border border-white">
        <h3 class="text-xl font-heading font-bold mb-1 text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 flex items-center">
            <svg class="inline w-5 h-5 mr-2 text-primary" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path>
            </svg>
            –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–µ–º—ã
        </h3>
        
        <div class="flex flex-wrap gap-2">
            <!-- All Posts Button -->
            <a href="{% url 'blog:post_list' %}" 
               class="tag-btn px-4 py-1.5 rounded-full font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg
                      {% if not current_tag and not current_category %}
                      bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 text-white shadow-pink-500/50 animate-gradient
                      {% else %}
                      bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 hover:from-pink-100 hover:to-purple-100 hover:text-primary
                      {% endif %}">
                ‚ú® –í—Å–µ —Å—Ç–∞—Ç—å–∏
            </a>
            
            <!-- Tag Buttons -->
            {% if tags %}
                {% for tag in tags %}
                <a href="{% url 'blog:post_by_tags' tag.slug %}" 
                   class="tag-btn px-4 py-1.5 rounded-full font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg relative overflow-hidden group
                          {% if current_tag and current_tag.slug == tag.slug %}
                          bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 text-white shadow-purple-500/50 animate-gradient
                          {% else %}
                          bg-gradient-to-r from-pink-400 to-purple-400 text-white hover:from-pink-500 hover:to-purple-500
                          {% endif %}">
                    <span class="relative z-10 flex items-center">
                        {{ tag.name }}
                        {% if tag.posts_count %}
                        <span class="ml-2 px-2 py-0.5 bg-white/20 rounded-full text-xs backdrop-blur-sm">{{ tag.posts_count }}</span>
                        {% endif %}
                    </span>
                    <!-- Hover effect -->
                    <div class="absolute inset-0 bg-gradient-to-r from-yellow-400 via-red-400 to-pink-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                </a>
                {% endfor %}
            {% else %}
                <span class="text-gray-500 text-sm italic">–¢–µ–≥–∏ –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã</span>
            {% endif %}
        </div>
    </div>
</div>

<style>
@keyframes gradient {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}

.animate-gradient {
    background-size: 200% 200%;
    animation: gradient 3s ease infinite;
}

.tag-btn {
    position: relative;
}

.tag-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 9999px;
    padding: 2px;
    background: linear-gradient(45deg, #ec4899, #8b5cf6, #3b82f6, #ec4899);
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    opacity: 0;
    transition: opacity 0.3s;
}

.tag-btn:hover::before {
    opacity: 0.5;
}
</style>
{% endblock %}

{% block content %}
<!-- Pagination Top -->
{% if is_paginated %}
<div class="mb-8">
    <!-- Pagination Info -->
    <div class="text-center mb-6">
        <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ <span class="text-primary text-2xl font-bold">{{ page_obj.number }}</span> 
            –∏–∑ <span class="text-primary text-2xl font-bold">{{ page_obj.paginator.num_pages }}</span>
        </p>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">
            –ü–æ–∫–∞–∑–∞–Ω–æ {{ page_obj.start_index }}-{{ page_obj.end_index }} –∏–∑ {{ page_obj.paginator.count }} —Å—Ç–∞—Ç–µ–π
        </p>
    </div>
    
    <!-- Pagination Controls -->
    <nav class="flex justify-center" aria-label="Pagination">
        <div class="flex items-center space-x-3">
            <!-- First & Previous -->
            {% if page_obj.has_previous %}
            <a href="?page=1" 
               class="group flex items-center gap-2 px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white dark:hover:bg-primary transition-all shadow-md hover:shadow-xl transform hover:scale-105"
               title="–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                </svg>
                <span class="hidden sm:inline font-medium">–ü–µ—Ä–≤–∞—è</span>
            </a>
            <a href="?page={{ page_obj.previous_page_number }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl hover:shadow-xl transition-all transform hover:scale-105"
               title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="font-semibold">–ù–∞–∑–∞–¥</span>
            </a>
            {% else %}
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                </svg>
                <span class="hidden sm:inline font-medium">–ü–µ—Ä–≤–∞—è</span>
            </span>
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="font-medium">–ù–∞–∑–∞–¥</span>
            </span>
            {% endif %}
            
            <!-- Page Numbers -->
            <div class="hidden md:flex items-center space-x-2">
                {% for p in paginator.page_range %}
                    {% if page_obj.number == p %}
                        <span class="px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-bold shadow-xl text-lg border-2 border-white transform scale-110">
                            {{ p }}
                        </span>
                    {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2 %}
                        <a href="?page={{ p }}" 
                           class="px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white transition-all shadow-md hover:shadow-xl transform hover:scale-105 font-semibold">
                            {{ p }}
                        </a>
                    {% elif p == 1 or p == page_obj.paginator.num_pages %}
                        <a href="?page={{ p }}" 
                           class="px-4 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white transition-all shadow-md hover:shadow-xl transform hover:scale-105 font-semibold">
                            {{ p }}
                        </a>
                    {% elif p == page_obj.number|add:-3 or p == page_obj.number|add:3 %}
                        <span class="px-2 text-gray-400 dark:text-gray-500 font-bold">...</span>
                    {% endif %}
                {% endfor %}
            </div>
            
            <!-- Next & Last -->
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl hover:shadow-xl transition-all transform hover:scale-105"
               title="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <span class="font-semibold">–í–ø–µ—Ä—ë–¥</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
            <a href="?page={{ page_obj.paginator.num_pages }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white dark:hover:bg-primary transition-all shadow-md hover:shadow-xl transform hover:scale-105"
               title="–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <span class="hidden sm:inline font-medium">–ü–æ—Å–ª–µ–¥–Ω—è—è</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                </svg>
            </a>
            {% else %}
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <span class="font-medium">–í–ø–µ—Ä—ë–¥</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </span>
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <span class="hidden sm:inline font-medium">–ü–æ—Å–ª–µ–¥–Ω—è—è</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                </svg>
            </span>
            {% endif %}
        </div>
    </nav>
    
    <!-- Quick Jump (for mobile) -->
    <div class="md:hidden mt-6 text-center">
        <div class="inline-flex items-center gap-3 bg-white dark:bg-gray-800 px-6 py-4 rounded-xl shadow-lg">
            <label for="page-jump-top" class="text-sm font-semibold text-gray-700 dark:text-gray-300">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:</label>
            <select id="page-jump-top" 
                    onchange="window.location.href='?page=' + this.value"
                    class="px-4 py-2 bg-gray-50 dark:bg-gray-700 border-2 border-primary text-gray-900 dark:text-white rounded-lg font-semibold focus:ring-2 focus:ring-primary">
                {% for p in paginator.page_range %}
                <option value="{{ p }}" {% if page_obj.number == p %}selected{% endif %}>{{ p }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
</div>
{% endif %}

<!-- Posts Grid with max 4 columns, centered -->
<div class="flex justify-center mb-8">
    <div class="w-full max-w-7xl mx-auto">
        <div class="grid gap-6" style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); grid-auto-flow: dense;">
    {% for post in post_list %}
    <article class="bg-white dark:bg-gray-800 rounded-xl shadow-md dark:shadow-gray-700 overflow-hidden card-hover fade-in group transition-colors duration-300">
        <!-- Post Image/Video -->
        <a href="{{ post.get_absolute_url }}" class="block relative group">
            {% with post.video_url|default:''|lower as video_url_lower %}
            <div class="relative w-full aspect-video bg-black overflow-hidden">
                <div class="absolute inset-0 flex items-center justify-center">
                    {% if post.video_url|is_video %}
                        {# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –≤–∏–¥–µ–æ-—Å—Å—ã–ª–∫–∞ #}
                        <iframe src="{{ post.video_url|video_embed }}"
                                class="{% if 'shorts' in video_url_lower or 'reel' in video_url_lower or 'stories' in video_url_lower %}h-full w-auto max-w-full{% else %}w-full h-full{% endif %} pointer-events-none"
                                frameborder="0"
                                allow="autoplay; encrypted-media"
                                allowfullscreen
                                loading="lazy"
                                onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        </iframe>
                        <div style="display:none;" class="w-full h-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-white text-4xl pointer-events-none">
                            ‚ö†Ô∏è
                        </div>
                    {% elif post.kartinka %}
                        {% if post.kartinka.name|slice:"-4:" == ".mp4" or post.kartinka.name|slice:"-5:" == ".webm" or post.kartinka.name|slice:"-4:" == ".mov" %}
                            <video src="{{ post.kartinka.url }}" 
                                   class="js-video-orientation w-full h-full object-cover pointer-events-none"
                                   preload="metadata"
                                   autoplay 
                                   loop 
                                   muted 
                                   playsinline>
                                <source src="{{ post.kartinka.url }}" type="video/{% if post.kartinka.name|slice:'-4:' == '.mp4' %}mp4{% elif post.kartinka.name|slice:'-5:' == '.webm' %}webm{% else %}quicktime{% endif %}">
                            </video>
                        {% else %}
                            <img src="{% if post.thumbnail %}{{ post.thumbnail.url }}{% else %}{{ post.kartinka.url }}{% endif %}" 
                                 alt="{{ post.title }}" 
                                 loading="lazy"
                                 decoding="async"
                                 class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
                        {% endif %}
                    {% else %}
                        <div class="w-full h-full bg-gradient-to-br from-primary to-secondary flex items-center justify-center">
                            <span class="text-white text-6xl font-heading">üì∑</span>
                        </div>
                    {% endif %}
                </div>

                <!-- Overlay on Hover -->
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    <div class="absolute bottom-0 left-0 right-0 p-4 text-white">
                        <p class="text-sm line-clamp-3">{{ post.description|truncatechars:150 }}</p>
                    </div>
                </div>

                <!-- Category Badge -->
                {% if post.category %}
                <div class="absolute top-4 left-4">
                    <span class="px-3 py-1 bg-white/90 backdrop-blur-sm text-primary text-xs font-semibold rounded-full">
                        {{ post.category.title }}
                    </span>
                </div>
                {% endif %}
            </div>
            {% endwith %}
        </a>
        
        <!-- Post Content -->
        <div class="p-6">
            <h2 class="text-xl font-heading font-bold mb-3 text-gray-900 dark:text-white group-hover:text-primary transition-colors line-clamp-2">
                <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
            </h2>
            
            <!-- Meta Info -->
            <div class="space-y-3 mb-4">
                <!-- Author & Date -->
                <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                    <a href="{% url 'Visitor:profile_detail' slug=post.author.profile.slug %}" class="flex items-center hover:text-primary transition-colors">
                        <img src="{{ post.author.profile.get_avatar }}" alt="{{ post.author.username }}" class="w-6 h-6 rounded-full mr-2 border-2 border-gray-200 dark:border-gray-700 object-cover">
                        <span class="font-medium">{{ post.author.username }}</span>
                    </a>
                    <span class="text-xs">{{ post.created|date:"d.m.Y" }}</span>
                </div>
                
                <!-- Stats & Read More -->
                <div class="flex items-center justify-between">
                    <!-- Stats -->
                    <div class="flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400">
                        <!-- Views -->
                        <span class="flex items-center gap-1" title="–ü—Ä–æ—Å–º–æ—Ç—Ä—ã">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                            <span class="font-medium">{{ post.views }}</span>
                        </span>
                        
                        <!-- Comments -->
                        <span class="flex items-center gap-1 hover:text-primary transition-colors cursor-pointer" title="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                            <span class="font-medium">{{ post.comments.count }}</span>
                        </span>
                        
                        <!-- Likes -->
                        <span class="flex items-center gap-1 hover:text-pink-500 transition-colors cursor-pointer" title="–†–µ–∞–∫—Ü–∏–∏">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-medium">{{ post.get_likes_count }}</span>
                        </span>
                    </div>
                    
                    <!-- Read More Button -->
                    <a href="{{ post.get_absolute_url }}" class="inline-flex items-center text-primary hover:text-secondary font-semibold text-sm group/btn flex-shrink-0">
                        –ß–∏—Ç–∞—Ç—å
                        <svg class="w-4 h-4 ml-1 group-hover/btn:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </article>
    
    <!-- –†–µ–∫–ª–∞–º–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞ (–∫–∞–∂–¥—ã–µ 4 –ø–æ—Å—Ç–∞, —á–µ—Ä–µ–¥—É–µ—Ç—Å—è) -->
    {% if forloop.counter|divisibleby:4 and not forloop.last %}
    <div class="col-span-full my-4">
        {% cycle 'in_post_middle' 'in_post_middle_1' 'in_post_middle_2' as banner_rotation silent %}
        {% show_ad banner_rotation %}
    </div>
    {% endif %}
    
    {% empty %}
    <div class="col-span-full text-center py-12">
        <p class="text-gray-500 text-lg">–°—Ç–∞—Ç—å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
    </div>
    {% endfor %}
        </div>
    </div>
</div>

<!-- Pagination -->
{% if is_paginated %}
<div class="my-12">
    <!-- Pagination Info -->
    <div class="text-center mb-6">
        <p class="text-lg font-semibold text-gray-700 dark:text-gray-300">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ <span class="text-primary text-2xl font-bold">{{ page_obj.number }}</span> 
            –∏–∑ <span class="text-primary text-2xl font-bold">{{ page_obj.paginator.num_pages }}</span>
        </p>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">
            –ü–æ–∫–∞–∑–∞–Ω–æ {{ page_obj.start_index }}-{{ page_obj.end_index }} –∏–∑ {{ page_obj.paginator.count }} —Å—Ç–∞—Ç–µ–π
        </p>
    </div>
    
    <!-- Pagination Controls -->
    <nav class="flex justify-center" aria-label="Pagination">
        <div class="flex items-center space-x-3">
            <!-- First & Previous -->
            {% if page_obj.has_previous %}
            <a href="?page=1" 
               class="group flex items-center gap-2 px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white dark:hover:bg-primary transition-all shadow-md hover:shadow-xl transform hover:scale-105"
               title="–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                </svg>
                <span class="hidden sm:inline font-medium">–ü–µ—Ä–≤–∞—è</span>
            </a>
            <a href="?page={{ page_obj.previous_page_number }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl hover:shadow-xl transition-all transform hover:scale-105"
               title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="font-semibold">–ù–∞–∑–∞–¥</span>
            </a>
            {% else %}
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
                </svg>
                <span class="hidden sm:inline font-medium">–ü–µ—Ä–≤–∞—è</span>
            </span>
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
                <span class="font-medium">–ù–∞–∑–∞–¥</span>
            </span>
            {% endif %}
            
            <!-- Page Numbers -->
            <div class="hidden md:flex items-center space-x-2">
                {% for p in paginator.page_range %}
                    {% if page_obj.number == p %}
                        <span class="px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl font-bold shadow-xl text-lg border-2 border-white transform scale-110">
                            {{ p }}
                        </span>
                    {% elif p >= page_obj.number|add:-2 and p <= page_obj.number|add:2 %}
                        <a href="?page={{ p }}" 
                           class="px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white transition-all shadow-md hover:shadow-xl transform hover:scale-105 font-semibold">
                            {{ p }}
                        </a>
                    {% elif p == 1 or p == page_obj.paginator.num_pages %}
                        <a href="?page={{ p }}" 
                           class="px-4 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white transition-all shadow-md hover:shadow-xl transform hover:scale-105 font-semibold">
                            {{ p }}
                        </a>
                    {% elif p == page_obj.number|add:-3 or p == page_obj.number|add:3 %}
                        <span class="px-2 text-gray-400 dark:text-gray-500 font-bold">...</span>
                    {% endif %}
                {% endfor %}
            </div>
            
            <!-- Next & Last -->
            {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-primary to-secondary text-white rounded-xl hover:shadow-xl transition-all transform hover:scale-105"
               title="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <span class="font-semibold">–í–ø–µ—Ä—ë–¥</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
            <a href="?page={{ page_obj.paginator.num_pages }}" 
               class="group flex items-center gap-2 px-5 py-3 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-primary hover:text-white dark:hover:bg-primary transition-all shadow-md hover:shadow-xl transform hover:scale-105"
               title="–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞">
                <span class="hidden sm:inline font-medium">–ü–æ—Å–ª–µ–¥–Ω—è—è</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                </svg>
            </a>
            {% else %}
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <span class="font-medium">–í–ø–µ—Ä—ë–¥</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </span>
            <span class="flex items-center gap-2 px-5 py-3 bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-xl cursor-not-allowed opacity-50">
                <span class="hidden sm:inline font-medium">–ü–æ—Å–ª–µ–¥–Ω—è—è</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                </svg>
            </span>
            {% endif %}
        </div>
    </nav>
    
    <!-- Quick Jump (for mobile) -->
    <div class="md:hidden mt-6 text-center">
        <div class="inline-flex items-center gap-3 bg-white dark:bg-gray-800 px-6 py-4 rounded-xl shadow-lg">
            <label for="page-jump" class="text-sm font-semibold text-gray-700 dark:text-gray-300">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:</label>
            <select id="page-jump" 
                    onchange="window.location.href='?page=' + this.value"
                    class="px-4 py-2 bg-gray-50 dark:bg-gray-700 border-2 border-primary text-gray-900 dark:text-white rounded-lg font-semibold focus:ring-2 focus:ring-primary">
                {% for p in paginator.page_range %}
                <option value="{{ p }}" {% if page_obj.number == p %}selected{% endif %}>{{ p }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
</div>
{% endif %}

<!-- Newsletter Section -->
<div class="bg-white rounded-2xl shadow-lg p-8 md:p-12 mb-8">
    <div class="max-w-2xl mx-auto text-center">
        <h3 class="text-3xl font-heading font-bold mb-4 text-gray-900">
            –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à—É —Ä–∞—Å—Å—ã–ª–∫—É
        </h3>
        <p class="text-gray-600 mb-6">
            –ü–æ–ª—É—á–∞–π—Ç–µ —Å–≤–µ–∂–∏–µ —Å—Ç–∞—Ç—å–∏ –æ –º–æ–¥–µ, –∫—Ä–∞—Å–æ—Ç–µ –∏ —Å—Ç–∏–ª–µ –ø—Ä—è–º–æ –Ω–∞ –≤–∞—à—É –ø–æ—á—Ç—É
        </p>
        <form class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto">
            <input type="email" 
                   placeholder="–í–∞—à email" 
                   class="flex-1 px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all">
            <button type="submit" class="px-6 py-3 bg-primary text-white rounded-lg hover:opacity-90 transition-all font-medium shadow-lg">
                –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è
            </button>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
{{ block.super }}
{% include 'partials/video_orientation_script.html' %}
{% endblock %}
