{% extends 'base_tailwind.html' %}
{% load static %}

{% block title %}AI-–ê–≥–µ–Ω—Ç - IdealImage.ru{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 text-gray-900 dark:text-gray-100">
    <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
    <div class="mb-4 text-sm text-gray-600 dark:text-gray-300">
        <a href="/dashboard/" class="text-blue-600 dark:text-blue-400 hover:underline">–ì–ª–∞–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥</a>
        <span class="mx-2 text-gray-400 dark:text-gray-500">‚Üí</span>
        <a href="{% url 'sozseti:dashboard' %}" class="text-blue-600 dark:text-blue-400 hover:underline">–°–æ—Ü—Å–µ—Ç–∏</a>
        <span class="mx-2 text-gray-400 dark:text-gray-500">‚Üí</span>
        <span class="text-gray-600 dark:text-gray-300">AI-–ê–≥–µ–Ω—Ç</span>
    </div>
    
    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white">AI-–ê–≥–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞–º–∏</h1>
            <p class="text-gray-500 dark:text-gray-300 mt-2">–£–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</p>
        </div>
        <a href="{% url 'sozseti:dashboard' %}" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg">
            <i class="fas fa-arrow-left mr-2"></i>–ù–∞–∑–∞–¥ –∫ –°–æ—Ü—Å–µ—Ç—è–º
        </a>
    </div>
    
    <!-- AI –ß–∞—Ç -->
    <div class="bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg shadow-lg p-6 mb-8 text-white">
        <div class="flex items-center mb-4">
            <i class="fas fa-robot text-4xl mr-4"></i>
            <div>
                <h2 class="text-2xl font-bold">AI –ü–æ–º–æ—â–Ω–∏–∫</h2>
                <p class="text-purple-100">–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ –ø–æ–º–æ—â—å —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫–∞–Ω–∞–ª–∞–º–∏</p>
            </div>
        </div>
        
        <!-- –ß–∞—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
        <div class="bg-white dark:bg-gray-900 rounded-lg p-4 text-gray-800 dark:text-gray-200" style="min-height: 400px;">
            <div id="chat-messages" class="mb-4 h-80 overflow-y-auto space-y-4">
                <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4">
                    <p class="font-semibold text-purple-600 dark:text-purple-300">AI:</p>
                    <p>–ü—Ä–∏–≤–µ—Ç! –Ø AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º–∏ Telegram –∫–∞–Ω–∞–ª–∞–º–∏. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥:</p>
                    <ul class="text-sm text-gray-600 dark:text-gray-400 ml-4 mt-1 list-disc">
                        <li>‚Ä¢ "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–Ω–∞–ª–∞ @ideal_image_ru"</li>
                        <li>‚Ä¢ "–ö–∞–∫–æ–π –∫–∞–Ω–∞–ª –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç–∞—Ç—å–∏ –æ –∫—Ä–∞—Å–æ—Ç–µ?"</li>
                        <li>‚Ä¢ "–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–π"</li>
                        <li>‚Ä¢ "–ü—Ä–µ–¥–ª–æ–∂–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤"</li>
                    </ul>
                </div>
            </div>
            
            <form id="ai-chat-form" class="flex gap-2">
                <input type="text" id="chat-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..." 
                       class="flex-1 border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500">
                <button type="submit" class="px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg">
                    <i class="fas fa-paper-plane mr-2"></i>–û—Ç–ø—Ä–∞–≤–∏—Ç—å
                </button>
            </form>
        </div>
    </div>
    
    <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white"><i class="fas fa-lightbulb text-yellow-500 mr-2"></i>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
            <ul class="space-y-3">
                <li class="flex items-start">
                    <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
                    <span class="text-sm text-gray-700 dark:text-gray-300">–ö–∞–Ω–∞–ª @KOSICHKI_GIRLS –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å (620 –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤)</span>
                </li>
                <li class="flex items-start">
                    <i class="fas fa-info-circle text-blue-500 mt-1 mr-2"></i>
                    <span class="text-sm text-gray-700 dark:text-gray-300">–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–π: 10:00, 14:00, 19:00</span>
                </li>
                <li class="flex items-start">
                    <i class="fas fa-chart-line text-purple-500 mt-1 mr-2"></i>
                    <span class="text-sm text-gray-700 dark:text-gray-300">–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ @ideal_image_ru</span>
                </li>
            </ul>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
            <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white"><i class="fas fa-chart-bar text-blue-500 mr-2"></i>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
            <ul class="space-y-3">
                <li class="flex justify-between">
                    <span class="text-sm text-gray-700 dark:text-gray-300">–í—Å–µ–≥–æ –∫–∞–Ω–∞–ª–æ–≤:</span>
                    <span class="font-semibold text-gray-900 dark:text-gray-100">{{ channels.count }}</span>
                </li>
                <li class="flex justify-between">
                    <span class="text-sm text-gray-700 dark:text-gray-300">–ü—É–±–ª–∏–∫–∞—Ü–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é:</span>
                    <span class="font-semibold text-gray-900 dark:text-gray-100">{{ recent_publications.count }}</span>
                </li>
                <li class="flex justify-between">
                    <span class="text-sm text-gray-700 dark:text-gray-300">–°—Ä–µ–¥–Ω—è—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å:</span>
                    <span class="font-semibold text-green-600 dark:text-green-400">2.5%</span>
                </li>
            </ul>
        </div>
    </div>
    
    <!-- –ö–∞–Ω–∞–ª—ã –ø–æ–¥ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º AI -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8">
        <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Telegram –∫–∞–Ω–∞–ª—ã</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {% for channel in channels %}
            <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-lg transition">
                <h3 class="font-semibold mb-2 text-gray-900 dark:text-gray-100">{{ channel.channel_name }}</h3>
                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">{{ channel.channel_id }}</p>
                <p class="text-lg font-bold text-blue-600 dark:text-blue-400">{{ channel.subscribers_count|default:0 }}</p>
                <p class="text-xs text-gray-500 dark:text-gray-400">–ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">–ü—É–±–ª–∏–∫–∞—Ü–∏–π: {{ channel.publications_count|default:0 }}</p>
                <a href="{% url 'sozseti:channel_detail' channel.pk %}" class="text-xs text-blue-600 dark:text-blue-400 hover:underline mt-2 block">
                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Üí
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è AI -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
        <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</h2>
        <div class="space-y-2">
            {% for pub in recent_publications|slice:":10" %}
            <div class="flex items-center justify-between border-b border-gray-200 dark:border-gray-700 pb-2">
                <div class="flex-1">
                    <p class="text-sm font-medium text-gray-900 dark:text-gray-100">{{ pub.post.title|truncatewords:10 }}</p>
                    <p class="text-xs text-gray-500 dark:text-gray-400">{{ pub.channel.channel_name }} ‚Ä¢ {{ pub.published_at|date:"d.m.Y H:i" }}</p>
                </div>
                <div class="text-right">
                    <p class="text-xs text-gray-500 dark:text-gray-400">üëÅÔ∏è {{ pub.views_count|default:0 }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<script>
document.getElementById('ai-chat-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const input = document.getElementById('chat-input');
    const message = input.value;
    
    if (message.trim()) {
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const messagesDiv = document.getElementById('chat-messages');
        const userMsg = document.createElement('div');
        userMsg.className = 'bg-blue-100 dark:bg-blue-900/40 rounded-lg p-4 ml-auto max-w-md text-gray-900 dark:text-blue-100';
        userMsg.innerHTML = '<p class="font-semibold text-blue-600 dark:text-blue-300">–í—ã:</p><p>' + message + '</p>';
        messagesDiv.appendChild(userMsg);
        
        // –û—Ç–≤–µ—Ç AI (–¥–µ–º–æ)
        setTimeout(() => {
            const aiMsg = document.createElement('div');
            aiMsg.className = 'bg-gray-100 dark:bg-gray-800 rounded-lg p-4 text-gray-800 dark:text-gray-200';
            aiMsg.innerHTML = '<p class="font-semibold text-purple-600 dark:text-purple-300">AI:</p><p>–§—É–Ω–∫—Ü–∏—è AI-—á–∞—Ç–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –°–∫–æ—Ä–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–∞–º–∏!</p>';
            messagesDiv.appendChild(aiMsg);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }, 1000);
        
        input.value = '';
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
});
</script>
{% endblock %}

