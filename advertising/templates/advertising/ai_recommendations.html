{% extends 'base_tailwind.html' %}
{% load static %}

{% block title %}–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI - IdealImage.ru{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="mb-8">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <h1 class="text-5xl font-black text-white mb-2">
                        ü§ñ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ AI
                    </h1>
                    <p class="text-xl text-gray-300">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã</p>
                </div>
                <div class="flex gap-3">
                    <a href="{% url 'advertising:dashboard' %}" 
                       class="px-4 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-md text-white font-semibold rounded-lg transition-colors border border-white/20">
                        ‚Üê –ù–∞–∑–∞–¥
                    </a>
                </div>
            </div>
        </div>
        
        <!-- –§–∏–ª—å—Ç—Ä -->
        <div class="bg-white/10 backdrop-blur-md rounded-2xl p-6 border border-white/20 mb-8">
            <form method="get" class="flex items-center gap-4">
                <label class="text-white font-semibold">–°—Ç–∞—Ç—É—Å:</label>
                <select name="status" onchange="this.form.submit()" 
                        class="px-4 py-2 bg-white/10 border border-white/20 text-white rounded-lg">
                    <option value="" class="bg-gray-800">–í—Å–µ</option>
                    <option value="active" class="bg-gray-800">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                    <option value="applied" class="bg-gray-800">–ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                </select>
            </form>
        </div>
        
        <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ -->
        <div class="space-y-4">
            {% for rec in recommendations %}
            <div class="bg-gradient-to-r from-purple-900/50 to-pink-900/50 backdrop-blur-md rounded-2xl p-6 border border-purple-500/30">
                <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                        <div class="flex items-center gap-3 mb-3">
                            <h3 class="text-2xl font-bold text-white">{{ rec.campaign.name }}</h3>
                            {% if rec.is_applied %}
                            <span class="px-3 py-1 bg-green-500/30 text-green-200 rounded-full text-xs font-semibold">–ü—Ä–∏–º–µ–Ω–µ–Ω–∞</span>
                            {% else %}
                            <span class="px-3 py-1 bg-yellow-500/30 text-yellow-200 rounded-full text-xs font-semibold">–ù–æ–≤–∞—è</span>
                            {% endif %}
                        </div>
                        
                        <p class="text-gray-300 mb-4">{{ rec.recommendation_reason }}</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="bg-white/10 rounded-lg p-3">
                                <p class="text-gray-400 text-xs mb-1">–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å AI</p>
                                <p class="text-purple-300 text-xl font-bold">{{ rec.confidence_score }}%</p>
                            </div>
                            <div class="bg-white/10 rounded-lg p-3">
                                <p class="text-gray-400 text-xs mb-1">–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π CTR</p>
                                <p class="text-green-300 text-xl font-bold">{{ rec.predicted_ctr }}%</p>
                            </div>
                            <div class="bg-white/10 rounded-lg p-3">
                                <p class="text-gray-400 text-xs mb-1">–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –¥–æ—Ö–æ–¥</p>
                                <p class="text-yellow-300 text-xl font-bold">{{ rec.predicted_revenue|floatformat:0 }}‚ÇΩ</p>
                            </div>
                            {% if rec.actual_ctr %}
                            <div class="bg-white/10 rounded-lg p-3">
                                <p class="text-gray-400 text-xs mb-1">–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π CTR</p>
                                <p class="text-blue-300 text-xl font-bold">{{ rec.actual_ctr }}%</p>
                            </div>
                            {% endif %}
                        </div>
                        
                        <div class="text-sm text-gray-400">
                            {% if rec.place %}
                            –ú–µ—Å—Ç–æ: <span class="text-white">{{ rec.place.name }}</span>
                            {% endif %}
                            {% if rec.post %}
                            | –°—Ç–∞—Ç—å—è: <span class="text-white">{{ rec.post.title }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    {% if not rec.is_applied %}
                    <form method="post" action="{% url 'advertising:apply_recommendation' rec.id %}">
                        {% csrf_token %}
                        <button type="submit" 
                                class="px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg transition-colors">
                            –ü—Ä–∏–º–µ–Ω–∏—Ç—å
                        </button>
                    </form>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <div class="bg-white/10 backdrop-blur-md rounded-2xl p-12 border border-white/20 text-center">
                <p class="text-gray-400 text-lg">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <p class="text-gray-500 text-sm mt-2">–°–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</p>
            </div>
            {% endfor %}
        </div>
        
    </div>
</div>
{% endblock %}







